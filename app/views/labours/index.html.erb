<%= link_to 'Nueva labor', new_labour_path %><br><br>

<%= form_tag labours_path, method: :get, id: 'filter-form' do %>
  <%= label_tag :category_id, 'Filtrar por categorÃ­a:' %>
  <%= select_tag :category_id, options_for_select(Category.categories_and_subcategories.map { |c| ["#{c.parent.name} - #{c.name}", c.id] }, params[:category_id]), prompt: 'Todas las labores', onchange: 'submitFilterForm()' %>
  <%= submit_tag 'Filtrar', style: 'display: none;' %>
<% end %>

<script>
  function submitFilterForm() {
    document.getElementById('filter-form').submit();
  }
</script>

<h1>Lista de labores</h1>

<table>
  <thead>
    <tr>
      <th>Descripcion</th>
      <th>Fecha de inicio</th>
      <th>Fecha final</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    <%= render partial: 'labour', collection: @labours %>
  </tbody>
</table>